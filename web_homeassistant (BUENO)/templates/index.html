<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Inicio / Perfil</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index1.css') }}">
</head>
<body>

<header class="main-header">
    <div class="nav-left">
        <div class="dropdown">
            <span>&gt; Panel principal</span>
            <div class="dropdown-content">
                <a href="{{ url_for('datos_sensor') }}">Datos sensores</a>
            </div>
        </div>
    </div>

    <div class="nav-center">
        <img src="{{ url_for('static', filename='img/img.png') }}" alt="Logo Fundación" class="logo">
    </div>

    <div class="nav-right">
        <img src="{{ url_for('static', filename='img/img_1.png') }}" alt="Foto perfil">
        <div class="dropdown">
            <span>{{ nombre }}</span>
            <div class="dropdown-content">
                <a href="{{ url_for('logout') }}">Cerrar sesión</a>
            </div>
        </div>
    </div>
</header>
<main>
    <div class="fila-principal">
        <!-- Columna izquierda -->
        <div class="columna-izquierda">
            <!-- Buscador -->
            <h2 class="titulo-buscador">Buscador de usuarios</h2>
            <form class="buscador" method="GET" action="{{ url_for('home') }}">
                <input
                        type="text"
                        name="usuario"
                        placeholder="Escribe el nombre de usuario"
                        list="usuarios"
                        autocomplete="off"
                        value="{{ request.args.get('usuario', '') }}"
                >
                <datalist id="usuarios">
                    {% for u in usuarios %}
                    <option value="{{ u.nombre_usuario }}"></option>
                    {% endfor %}
                </datalist>
                <input type="submit" style="display:none">
            </form>

            {% if user_detail %}
            <!-- Sección de actividades con tabla -->
            <section class="tabla-actividades">
                <h3>Actividades del día</h3>
                <form method="GET" action="{{ url_for('home') }}">
                    <input type="hidden" name="usuario" value="{{ request.args.get('usuario') }}">
                    <input type="date" name="fecha" class="selector-fecha" value="{{ request.args.get('fecha', '') }}">
                    <input type="submit" value="Buscar" class="boton-fecha">
                </form>

                {% if actividades %}
                <table class="tabla">
                    <thead>
                    <tr>
                        <th>Hora Inicio - Hora Fin</th>
                        <th>Nombre Actividad</th>
                        <th>Hora Realizada</th>
                        <th>Estado</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for act in actividades %}
                    <tr>
                        <td>{{ act.hora_inicio }} - {{ act.hora_fin }}</td>
                        <td>{{ act.nombre }}</td>
                        <td>{{ act.hora_realizada }}</td>
                        <td>{{ act.estado }}</td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p>No hay actividades para la fecha seleccionada.</p>
                {% endif %}
            </section>
            {% endif %}
        </div>

        <!-- Columna derecha -->
        {% if user_detail %}
        <div class="columna-derecha">
            <section class="perfil-contenedor">
                <img src="{{ url_for('static', filename='img/img_1.png') }}" alt="Foto perfil" class="foto-perfil">
                <div class="datos-perfil">
                    <h2>{{ user_detail.nombre_usuario }}</h2>
                    <hr>
                </div>
            </section>
        </div>
        {% endif %}
    </div>
</main>
</body>
</html>
