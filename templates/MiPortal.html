<!doctype html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>MiPortal</title>
    <link rel="stylesheet" href="../static/css/MiPortal.css">
</head>
<body>
<header class="main-header" id="movible-header">
    <div class="nav-left">
        <a href="{{ url_for('root') }}">
            <img src="../static/img/logo_casa.png" alt="Logo_Casa" class="Logo_Casa" />
        </a>
    </div>

    <div class="nav-center">
        <img src="../static/img/img.png" alt="Logo Fundación" class="logo" />
    </div>

    <div class="nav-right">
        <img src="../static/img/img_1.png" alt="Foto perfil" />
        <div class="dropdown">
            <span>{{ usuario or "Nombre Usuario" }}</span>
            <div class="dropdown-content">
                <a href="{{ url_for('logout') }}">Cerrar sesión</a>
            </div>
        </div>
    </div>
</header>
<main>
    <!-- Columna principal (menú) -->
    <aside id="menu-principal">
        <nav>
            <button class="menu-btn" data-section="trabajador">Administrar trabajador</button>
            <button class="menu-btn" data-section="clientes">Administrar clientes</button>
            <button class="menu-btn" data-section="hogares">Administrar hogares</button>
        </nav>
    </aside>

    <!-- Columna secundaria -->
    <div id="columna-secundaria"></div>

    <!-- Contenido general -->
    <section id="contenido-principal"></section>
</main>
<script>
    const secundaria = document.getElementById('columna-secundaria');
    const contenidoPrincipal = document.getElementById('contenido-principal');

    const listaGestores = ['Juan Pérez', 'María López', 'Carlos Sánchez', 'Ana Gómez'];

    const opcionesSecundarias = {
        trabajador: `
            <div class="subopcion" data-subtipo="gestor">Gestor</div>
            <div class="subopcion" data-subtipo="cuidador">Cuidador</div>
        `,
        clientes: `
            <div class="subopcion" data-subtipo="cliente">Clientes</div>
        `,
        hogares: `
            <div class="subopcion" data-subtipo="hogares">Hogares</div>
        `
    };

    const accionesContenido = {
        gestor: `
            <div class="gestor-layout">
                <div class="opciones-gestor">
                    <ul>
                        <li id="btn-anadir-gestor">Añadir gestor</li>
                        <li>Eliminar gestor</li>
                        <li>Modificar gestor</li>
                    </ul>
                </div>
                <div id="formulario-gestor-container"></div>
            </div>
        `,
        cuidador: `
            <div class="gestor-layout">
                <div class="opciones-gestor">
                    <ul>
                        <li id="btn-anadir-cuidador">Añadir cuidador</li>
                        <li>Eliminar cuidador</li>
                        <li>Modificar cuidador</li>
                        <li>Horario</li>
                    </ul>
                </div>
                <div id="formulario-gestor-container"></div>
            </div>
        `,
        cliente: `
            <div class="gestor-layout">
                <div class="opciones-gestor">
                    <ul>
                        <li id="btn-anadir-cliente">Añadir cliente</li>
                        <li>Eliminar cliente</li>
                        <li>Modificar cliente</li>
                    </ul>
                </div>
                <div id="formulario-gestor-container"></div>
            </div>
        `,
        hogares: `
            <div class="gestor-layout">
                <div class="opciones-gestor">
                    <ul>
                        <li id="btn-anadir-hogar">Añadir hogares</li>
                        <li>Eliminar hogares</li>
                        <li>Modificar hogares</li>
                    </ul>
                </div>
                <div id="formulario-gestor-container"></div>
            </div>
        `
    };

    document.querySelectorAll('.menu-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const section = btn.dataset.section;
            secundaria.innerHTML = opcionesSecundarias[section];
            secundaria.style.display = 'block';
            contenidoPrincipal.innerHTML = '';
            activarSubopciones();
        });
    });

    function activarSubopciones() {
        document.querySelectorAll('.subopcion').forEach(item => {
            item.addEventListener('click', () => {
                const subtipo = item.dataset.subtipo;
                contenidoPrincipal.innerHTML = accionesContenido[subtipo];

                if (subtipo === 'cuidador') {
                    activarOpcionesCuidador();
                } else if (subtipo === 'gestor') {
                    activarOpcionesGestor();
                } else if (subtipo === 'cliente') {
                    activarOpcionesCliente();
                } else if (subtipo === 'hogares') {
                    activarOpcionesHogar();
                }
            });
        });
    }

    function activarOpcionesGestor() {
        const listaOpciones = document.querySelectorAll('.opciones-gestor li');
        const formularioContenedor = document.getElementById('formulario-gestor-container');

        listaOpciones.forEach(opcion => {
            opcion.addEventListener('click', () => {
                if (opcion.id === 'btn-anadir-gestor') {
                    formularioContenedor.innerHTML = `
                        <form class="formulario">
                            <div class="campo-obligatorio-texto"><span>*</span> Campo obligatorio</div>
                            <label>Nombre <span style="color: red">*</span>
                                <input type="text" required>
                            </label>
                            <label>Primer apellido <span style="color: red">*</span>
                                <input type="text" required>
                            </label>
                            <label>Segundo apellido <span style="color: red">*</span>
                                <input type="text" required>
                            </label>
                            <label>Nombre de usuario <span style="color: red">*</span>
                                <input type="text" required>
                            </label>
                            <label>Contraseña <span style="color: red">*</span>
                                <input type="password" required>
                            </label>
                            <button type="submit">Guardar</button>
                        </form>
                    `;
                } else {
                    formularioContenedor.innerHTML = "";
                }
            });
        });
    }

    function activarOpcionesCuidador() {
        const listaOpciones = document.querySelectorAll('.opciones-gestor li');
        const formularioContenedor = document.getElementById('formulario-gestor-container');

        listaOpciones.forEach(opcion => {
            opcion.addEventListener('click', () => {
                if (opcion.id === 'btn-anadir-cuidador') {
                    formularioContenedor.innerHTML = `
                        <form class="formulario">
                            <div class="campo-obligatorio-texto"><span>*</span> Campo obligatorio</div>
                            <label>Nombre <span style="color: red">*</span>
                                <input type="text" required>
                            </label>
                            <label>Primer apellido <span style="color: red">*</span>
                                <input type="text" required>
                            </label>
                            <label>Segundo apellido <span style="color: red">*</span>
                                <input type="text" required>
                            </label>
                            <label>Nombre de usuario <span style="color: red">*</span>
                                <input type="text" required>
                            </label>
                            <label>Contraseña <span style="color: red">*</span>
                                <input type="password" required>
                            </label>
                            <label>Teléfono <span style="color: red">*</span>
                                <input type="tel" required>
                            </label>
                            <button type="submit">Guardar</button>
                        </form>
                    `;
                } else {
                    formularioContenedor.innerHTML = "";
                }
            });
        });
    }

    function activarOpcionesCliente() {
        const listaOpciones = document.querySelectorAll('.opciones-gestor li');
        const formularioContenedor = document.getElementById('formulario-gestor-container');

        listaOpciones.forEach(opcion => {
            opcion.addEventListener('click', () => {
                if (opcion.id === 'btn-anadir-cliente') {
                    formularioContenedor.innerHTML = `
<form class="formulario-dos-columnas">
    <div class="campo-obligatorio-texto"><span>*</span> Campo obligatorio</div>
    <div class="columna">
        <label>Gestor <span style="color: red">*</span>
            <input list="gestores" name="gestor" required>
            <datalist id="gestores">
                ${listaGestores.map(gestor => `<option value="${gestor}">`).join('')}
            </datalist>
        </label>
        <label>Nombre <span style="color: red">*</span>
            <input type="text" required>
        </label>
        <label>Primer apellido <span style="color: red">*</span>
            <input type="text" required>
        </label>
        <label>Segundo apellido <span style="color: red">*</span>
            <input type="text" required>
        </label>
        <label>DNI <span style="color: red">*</span>
            <input type="text" required>
        </label>
        <label>Sexo <span style="color: red">*</span>
            <select required>
                <option value="" disabled selected>Selecciona</option>
                <option value="masculino">Masculino</option>
                <option value="femenino">Femenino</option>
                <option value="otro">Otro</option>
            </select>
        </label>
        <label>Fecha de nacimiento <span style="color: red">*</span>
            <input type="date" required>
        </label>
    </div>
    <div class="columna">
        <label>Teléfono personal <span style="color: red">*</span>
            <input type="tel" required>
        </label>
        <label>Teléfono familiar <span style="color: red">*</span>
            <input type="tel" required>
        </label>
        <label>Descripción <span style="color: red">*</span>
            <textarea rows="3" required></textarea>
        </label>
    </div>
    <button type="submit">Guardar</button>
</form>
                    `;
                } else {
                    formularioContenedor.innerHTML = "";
                }
            });
        });
    }

    function activarOpcionesHogar() {
        const listaOpciones = document.querySelectorAll('.opciones-gestor li');
        const formularioContenedor = document.getElementById('formulario-gestor-container');

        listaOpciones.forEach(opcion => {
            opcion.addEventListener('click', () => {
                if (opcion.id === 'btn-anadir-hogar') {
                    formularioContenedor.innerHTML = `
<form class="formulario">
    <div class="campo-obligatorio-texto"><span>*</span> Campo obligatorio</div>
    <label>Dirección <span style="color: red">*</span>
        <input type="text" required>
    </label>
    <label>Código Postal <span style="color: red">*</span>
        <input type="text" required>
    </label>
    <label>Provincia <span style="color: red">*</span>
        <input type="text" required>
    </label>
    <label>URL Home Assistant <span style="color: red">*</span>
        <input type="url" required>
    </label>
    <label>Token Home Assistant <span style="color: red">*</span>
        <input type="text" required>
    </label>
    <button type="submit">Guardar</button>
</form>
                    `;
                } else {
                    formularioContenedor.innerHTML = "";
                }
            });
        });
    }
</script>
</body>
</html>
